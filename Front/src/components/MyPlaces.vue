<template>
  <div>
    <div class="welcome" :class="{'welcome-mobile': !isDesktop}">
      <img class="welcome__picture" :src="`${$baseUrl}/img/${welcomeImage.image}`" alt="Маршрутка">
      <div class="welcome__text">{{ welcomeImage.text }}</div>
    </div>
    <MyButton
      v-if="!isDesktop"
      title="Фильтры"
      :icon="'filter.svg'"
      class="places__filters-button"
      @click="toggleFiltersSize"
    />
    <div v-if="isFullSizeFilters | isDesktop" class="places__filters" :class="{'places__filters-mobile': !isDesktop}">
      <Select
        :name="'Категория'"
        :fieldName="'category'"
      />
      <Select
        :name="'Тип'"
        :fieldName="'type'"
      />
      <Select
        :name="'На чем'"
        :fieldName="'way'"
      />
    </div>
    <div class="page" :class="{'page-mobile': !isDesktop}">
      <MasonryWall :items="places" :columnWidth="350" type="place"/>
    </div>
  </div>
</template>

<script>
import Select from './CustomComponents/Select.vue'
import MyButton from './CustomComponents/MyButton.vue'
import MasonryWall from './CustomComponents/MasonryWall.vue'
export default {
  components: {
    Select,
    MyButton,
    MasonryWall
  },
  data(){
    return {
      isFullSizeFilters: false,
    }
  },
  computed: {
    selectedRegion() {
      return this.$store.state.placesModule.selectedRegion
    },
    places() {
      return this.$store.state.placesModule.places
    },
    welcomeImage() {
      if (this.selectedRegion) {
        return {image: this.places[0].picture, text: this.selectedRegion}
      } else {
        return {image: "chelovek-gora.jpeg", text: "Построй свой маршрут"}
      }
    },
    isDesktop(){
      return this.$store.state.appModule.isDesktop
    },
  },
  methods: {
    toggleFiltersSize() {
      this.isFullSizeFilters = !this.isFullSizeFilters;
    },
  },
  created() {
    this.$store.dispatch("getPlaces")
    this.$store.dispatch("getFilters")
  }
}
</script>

<style lang="scss" scoped>
.page {
  padding: 2% 10%;
  &-mobile {
    padding: 2%;
  }
}
.welcome {
  position:relative;
  height: 450px;
  &-mobile {
    height: 350px;
  }
}

.welcome__picture {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.welcome__text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  width: 90%;
  font-size: min(max(40px, 6vw), 70px);
  color: white;
  font-weight: 900;
}

.places__filters {
  @include panel(to bottom);
  font-weight: 500;
  color: rgb(105, 105, 105);
  &-mobile {
    flex-direction: column;
    gap: 20px;
    padding: 20px;
  }
  &-button {
    margin-top: 20px;
  }
}
</style>
